#!/bin/bash

# Ask for name
read -p "Enter your name: " name

BASE_DIR="submission_reminder_$name"

# Create main directories
mkdir -p "$BASE_DIR/app"
mkdir -p "$BASE_DIR/modules"
mkdir -p "$BASE_DIR/assets"
mkdir -p "$BASE_DIR/config"

# config.env file
cat << 'EOF' > "$BASE_DIR/config/config.env"
ASSIGNMENT="Math Homework"
DAYS_REMAINING=5
EOF

# Sample submissions.txt file
cat << 'EOF' > "$BASE_DIR/assets/submissions.txt"
John Doe - submitted
Jane Smith - not submitted
Alex Lee - submitted
Chris Evans - not submitted
EOF

# reminder.sh file
cat << 'EOF' > "$BASE_DIR/app/reminder.sh"
#!/bin/bash

# Get the directory of this script
SCRIPT_DIR="\$(cd "\$(dirname "\${BASH_SOURCE[0]}")" && pwd)"
BASE_DIR="\$(dirname "\$SCRIPT_DIR")"

# Source environment variables and helper functions
source "\$BASE_DIR/config/config.env"
source "\$BASE_DIR/modules/functions.sh"

# Path to the submissions file
submissions_file="\$BASE_DIR/assets/submissions.txt"

# Print remaining time and run the reminder function
echo "Assignment: \$ASSIGNMENT"
echo "Days remaining to submit: \$DAYS_REMAINING days"
echo "--------------------------------------------"

check_submissions "\$submissions_file"
EOF
chmod +x "$BASE_DIR/app/reminder.sh"

# functions.sh file
cat << 'EOF' > "$BASE_DIR/modules/functions.sh"
#!/bin/bash

# Function to read submissions file and output students who have not submitted
function check_submissions {
    local submissions_file=\$1

    if [[ ! -f "\$submissions_file" ]]; then
        echo "Error: Submissions file not found."
        return 1
    fi

    echo "Students who have not submitted:"
    grep "not submitted" "\$submissions_file"
}
EOF
chmod +x "$BASE_DIR/modules/functions.sh"

echo "setup complete! Run:"
echo "bash \"$BASE_DIR/app/reminder.sh\""

